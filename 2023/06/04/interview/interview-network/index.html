<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>前端面试题背诵纯享版（网络协议） | Neil&#39;s Blog</title>
    <meta name="author" content="Neil Ji" />
    <meta name="keywords" content="" />
    <meta name="description" content="TCP三次握手：C to S：SYN&amp;#x3D;1，seq&amp;#x3D;x；S to C：SYN&amp;#x3D;1，ACK&amp;#x3D;1，seq&amp;#x3D;y，ack&amp;#x3D;x+1；C to S：ACK&amp;#x3D;1，seq&amp;#x3D;x+1，ack&amp;#x3D;y+1；四次挥手：C to S：FIN&amp;#x3D;1，seq&amp;#x3D;u；S to C：ACK&amp;#x3D;1，seq&amp;#x3D;v，ack&amp;#x3D;u+1，服务器继续发送旧数据；S to C：FIN&amp;#x3D;1，ACK&amp;#x3D;1，" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="Neil&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
<meta name="generator" content="Hexo 6.3.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Neil&#39;s Blog</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <!-- <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://neil-ji.github.io"></form> -->

        
            
                
                    

                        
                            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP"><span class="toc-number">1.</span> <span class="toc-text">TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">三次握手：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">四次挥手：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">为什么是三次握手？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%EF%BC%9F"><span class="toc-number">1.4.</span> <span class="toc-text">为什么是四次挥手？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCP%E7%A1%AE%E4%BF%9D%E4%BC%A0%E8%BE%93%E5%8F%AF%E9%9D%A0%E7%9A%84%E6%9C%BA%E5%88%B6"><span class="toc-number">1.5.</span> <span class="toc-text">TCP确保传输可靠的机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">1.5.1.</span> <span class="toc-text">拥塞控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP"><span class="toc-number">2.</span> <span class="toc-text">UDP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP"><span class="toc-number">3.</span> <span class="toc-text">IP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS"><span class="toc-number">4.</span> <span class="toc-text">DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-number">5.</span> <span class="toc-text">HTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSL-x2F-TLS"><span class="toc-number">6.</span> <span class="toc-text">SSL&#x2F;TLS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-2-0"><span class="toc-number">7.</span> <span class="toc-text">HTTP 2.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-3-0"><span class="toc-number">8.</span> <span class="toc-text">HTTP 3.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Socket"><span class="toc-number">9.</span> <span class="toc-text">Socket</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6"><span class="toc-number">10.</span> <span class="toc-text">HTTP与浏览器缓存机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CORS"><span class="toc-number">11.</span> <span class="toc-text">CORS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">12.</span> <span class="toc-text">跨域访问限制与解决方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie"><span class="toc-number">13.</span> <span class="toc-text">Cookie</span></a></li></ol>
                                
    </div>
</aside>
</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            前端面试题背诵纯享版（网络协议）
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://neil-ji.github.io/2023/06/04/interview/interview-network/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2023-06-04T07:10:05.000Z" itemprop="datePublished">2023-06-04</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><h3 id="三次握手："><a href="#三次握手：" class="headerlink" title="三次握手："></a>三次握手：</h3><ol>
<li>C to S：SYN&#x3D;1，seq&#x3D;x；</li>
<li>S to C：SYN&#x3D;1，ACK&#x3D;1，seq&#x3D;y，ack&#x3D;x+1；</li>
<li>C to S：ACK&#x3D;1，seq&#x3D;x+1，ack&#x3D;y+1；</li>
</ol>
<h3 id="四次挥手："><a href="#四次挥手：" class="headerlink" title="四次挥手："></a>四次挥手：</h3><ol>
<li>C to S：FIN&#x3D;1，seq&#x3D;u；</li>
<li>S to C：ACK&#x3D;1，seq&#x3D;v，ack&#x3D;u+1，服务器继续发送旧数据；</li>
<li>S to C：FIN&#x3D;1，ACK&#x3D;1，seq&#x3D;w，ack&#x3D;u+1，服务器停止发送任何数据；</li>
<li>C to S：ACK&#x3D;1，seq&#x3D;u+1，ack&#x3D;w+1；</li>
</ol>
<p>第四次挥手后，客户端等待2MSL后再断开连接，否则如果服务器没有收到第四次挥手报文，将重复发送第三次挥手报文，由于此时客户端已经断开，服务器永远无法收到第四次挥手报文，将导致后续连接和数据包的混乱；</p>
<h3 id="为什么是三次握手？"><a href="#为什么是三次握手？" class="headerlink" title="为什么是三次握手？"></a>为什么是三次握手？</h3><p>确保双方同处于一个上下文中，使得信息同步，进而保证连接可靠性；</p>
<p>如果是一次握手，显然发起方不能确认连接是否成功建立；</p>
<p>如果是两次握手，接收方将无法确认发起方的第一次握手是否还有效，如果发起方第一次握手后放弃建立连接（非断开连接），客户端将无法感知到。</p>
<h3 id="为什么是四次挥手？"><a href="#为什么是四次挥手？" class="headerlink" title="为什么是四次挥手？"></a>为什么是四次挥手？</h3><p>相比三次握手，四次挥手多的是第二次挥手，这是因为第二次挥手是为了通知客户端还有旧数据要传输，传输完成后才可以说双方数据均以传输完毕，可以断开连接。</p>
<h3 id="TCP确保传输可靠的机制"><a href="#TCP确保传输可靠的机制" class="headerlink" title="TCP确保传输可靠的机制"></a>TCP确保传输可靠的机制</h3><ol>
<li>序列号和确认号；</li>
<li>超时重传；</li>
<li>流量控制；</li>
<li>拥塞控制；</li>
</ol>
<h4 id="拥塞控制"><a href="#拥塞控制" class="headerlink" title="拥塞控制"></a>拥塞控制</h4><p>滑动窗口的大小使用<strong>慢启动</strong>动态改变，一旦发生丢包或超时则启动<strong>快速重传</strong>或<strong>快速恢复</strong>；</p>
<p>飞包守恒原则：总是收到一个旧包的ack确认包才会发送新包；</p>
<p>慢启动：</p>
<ul>
<li>维护一个拥塞窗口大小，初始为1 MSS（最大报文长度，双方协商得到），发送窗口大小取拥塞窗口与接受窗口的较小者，每1RTT拥塞窗口翻倍（每收到一个ack，大小加一）；</li>
<li>维护一个慢启动阈值，初始为<code>2^16 - 1</code>，由<strong>快速重传</strong>或<strong>快速恢复</strong>算法，一旦拥塞窗口超过该值，启动<strong>拥塞避免</strong>算法；</li>
</ul>
<p>快速重传：丢包（收到连续三个相同ack），立即重发丢失的包，慢启动阈值设为拥塞窗口的一半，拥塞窗口大小置为1，重新开始慢启动；</p>
<p>快速恢复：丢包或超时（超过1RTO），则拥塞窗口减半，慢启动阈值设为拥塞窗口的一半，拥塞窗口大小置为慢启动阈值+3 MSS，之后进入拥塞避免；</p>
<p>拥塞避免：拥塞窗口大小累加1，当接收到</p>
<h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><h2 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h2><h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><h2 id="SSL-x2F-TLS"><a href="#SSL-x2F-TLS" class="headerlink" title="SSL&#x2F;TLS"></a>SSL&#x2F;TLS</h2><h2 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP 2.0"></a>HTTP 2.0</h2><h2 id="HTTP-3-0"><a href="#HTTP-3-0" class="headerlink" title="HTTP 3.0"></a>HTTP 3.0</h2><h2 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h2><h2 id="HTTP与浏览器缓存机制"><a href="#HTTP与浏览器缓存机制" class="headerlink" title="HTTP与浏览器缓存机制"></a>HTTP与浏览器缓存机制</h2><p>强缓存：由Catch-Control、Expires控制的缓存策略；</p>
<p>Catch-Control相关指令：</p>
<ul>
<li>如果不希望复用Response，使用no-store；</li>
<li>如果希望复用Response<ul>
<li>希望每次都验证资源有效性，使用no-catch；</li>
<li>不希望每次都验证<ul>
<li>允许中间服务器缓存，使用public；</li>
<li>（默认行为）不允许中间服务器缓存，使用private；</li>
</ul>
</li>
</ul>
</li>
<li>设置缓存有效时间，使用max-age&#x2F;s-max-age指令，优先级高于Expires首部；</li>
</ul>
<p>强缓存未命中的情况下，还有协商缓存策略：发送一条带有if-match&#x2F;if-modified-since首部的条件请求到源服务器，服务器验证资源有效性，有效则返回状态码304 Not Modified，失效则返回新资源，状态码200 OK;</p>
<p>注1：s-max-age可覆盖max-age和Expires，只能用于中间服务器缓存的时效控制；</p>
<p>注2：其他时效控制指令还有max-stale&#x2F;min-fresh等；</p>
<p>注3：private指令下，一般由浏览器本地缓存；</p>
<p>注4：if-match验证的是资源的ETag，if-modified-since验证的是资源的最近修改时间；</p>
<h2 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h2><p>Cross-Origin Resource Sharing（跨域资源共享），包含一组扩展的HTTP首部，跨域的<code>简单请求</code>将直接发送，<code>非简单请求</code>将发送一个method为options的preflight请求；</p>
<p>请求首部：</p>
<ol>
<li>Access-Control-Request-Method</li>
<li>Access-Control-Request-Headers</li>
<li>Origin</li>
</ol>
<p>响应首部：</p>
<ol>
<li>Access-Control-Allow-Methods</li>
<li>Access-Control-Allow-Headers</li>
<li>Access-Control-Expose-Headers</li>
<li>Access-Control-Allow-Origin</li>
<li>Access-Control-Allow-Credentials</li>
<li>Access-Control-Max-Age</li>
</ol>
<p>简单请求：</p>
<ul>
<li>Method为Get&#x2F;Post&#x2F;Head；</li>
<li>仅包含以下首部：<ul>
<li>Other Auto-seted by user-agent headers（Connection&#x2F;User-Agent）；</li>
<li>Content-Type 仅包含：<ul>
<li>application&#x2F;x-www-form-urlencoded；</li>
<li>text&#x2F;plain；</li>
<li>multipart&#x2F;form-data；</li>
</ul>
</li>
<li>Accept；</li>
<li>Accept-Language；</li>
<li>Content-Language；</li>
<li>Content-Type；</li>
<li>DPR；</li>
<li>Downlink；</li>
<li>Save-Data；</li>
<li>Viewport-Width；</li>
<li>Width；</li>
</ul>
</li>
</ul>
<p>注：简单、非简单请求为过时的称呼，现行规范中不再使用；</p>
<p>流程：</p>
<ol>
<li>浏览器判断请求为：<ol>
<li>简单请求，直接发送该请求；</li>
<li>非简单请求，则<ol>
<li>发送preflight请求；</li>
<li>服务器响应该preflight请求；</li>
<li>发送真实请求；</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>简单请求只需要通过Origin和Access-Control-Allow-Origin就可以控制跨域资源的访问；<br>非简单请求还需要通过*-Request-Method\Headers和*-Request-Methods\Headers来控制跨域HTTP报文允许哪些Method和Header，*-Max-Age指定一段时间内无需再次发送preflight请求；</p>
<h2 id="跨域访问限制与解决方案"><a href="#跨域访问限制与解决方案" class="headerlink" title="跨域访问限制与解决方案"></a>跨域访问限制与解决方案</h2><p>通信双方的协议、域名和端口都相同，则称之为同源，否则就是不同源，不同源之间的通信称为跨域访问（跨源访问），浏览器对跨域访问有限制，为了解决该问题，有以下方案：</p>
<ol>
<li>CORS</li>
<li>Websocket：websocket不受跨域限制；</li>
<li>Jsonp：提前定义好回调函数，构建script元素，将跨域请求URL写入src，插入DOM，由于静态资源加载允许跨域，所以可以发送跨域请求，服务器在返回的js片段中编写回调函数的调用代码，并将服务器端的数据以回调函数参数的形式拼接进去。</li>
<li>正向代理、反向代理：确保客户端与代理服务器不跨域，由代理服务器与目标服务器通信，服务器之间通信自然不受浏览器的规则限制；</li>
<li>postMessage &amp; onmessage：用于不同源tab或iframe之间跨域通信，postMessage发送数据，onmessage监听数据接收事件；</li>
</ol>
<p>注：</p>
<ul>
<li>正向代理：向指定的客户端负责，任何这些客户端的请求，都通过该代理服务器代为发送；</li>
<li>反向代理：向指定的服务端负责，任何这些服务端的响应，都通过该代理服务器代为发送；</li>
</ul>
<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>HTTP扩展首部：</p>
<ul>
<li>set-cookie：服务器在http响应报文中通过该首部通知浏览器设置cookie的值；</li>
<li>cookie：浏览器在http请求报文中通过该首部将cookie发送到服务器；</li>
<li>形式上如key&#x3D;value，多个键值对以分号<code>;</code>分隔；</li>
</ul>
<p>cookie指令：</p>
<ul>
<li>时效：<ul>
<li><code>Expires=&lt;date&gt;</code>：过期时间，默认为会话结束后过期；</li>
<li><code>Max-age=&lt;seconds&gt;</code>：有效时间，小于等于0将直接失效，优先级高于expires，兼容性差于expires；</li>
</ul>
</li>
<li>目标：<ul>
<li><code>Domain=&lt;domain&gt;</code>：指定访问哪些域需要携带cookie；</li>
<li><code>Path=&lt;path&gt;</code>：指定访问哪些资源路径（含所有子路径）需要携带cookie；</li>
</ul>
</li>
<li>安全：<ul>
<li><code>Secure</code>：只允许通过https携带cookie；</li>
<li><code>HttpOnly</code>：禁止js读写cookie；</li>
<li><code>SameSite=&lt;option&gt;</code>：B对A网站发起的请求是否允许携带A创建的cookie，可选项如下：<ul>
<li><code>strict</code>：完全禁止；</li>
<li><code>lax</code>：大部分禁止，只允许Get请求携带（超链接、Get表单、资源预加载）；</li>
<li><code>none</code>：不禁止；</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>注：浏览器禁止cookie跨域访问（读写），但允许跨域请求，即B不能读写A的cookie，但B对A可以发送请求，这个请求可以携带A的cookie，B相对于A来说是第三方网站，所以这个cookie也叫做第三方cookie，<strong>注意第三方cookie并不是第三方网站创建的cookie</strong>；</p>

        
    </section>
</article>



<a id="pagenext" href="/2023/06/04/interview/interview-websecurity/" class="article-next" title="前端面试题背诵纯享版（网络安全）"><i class="icon-arrow-right"></i></a>


<a id="pageprev" href="/2023/06/11/algorithm/algorithm_leetcode32/" class="article-prev" title="LeetCode Hard 32. 最长有效括号"><i class="icon-arrow-left"></i></a>




            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
</footer>

    </main>

    <script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle('normal', slideDone);
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp('normal', slideDone);
            }, 3000);
        }

        function slideDone() {
            if (nodes.navInner.css('display') !== 'none') {
                nodes.navInner.css('display', '');
            }
        }

        $(window).on('resize', function() {
            if ($(this).width() > 960) {
                nodes.navInner.css('display', '');
            }
        });
    });
    </script>
    
        
<script src="/js/scrollspy.min.js"></script>

        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});

        $(window).on('resize', function() {
            var hw = $('#header').width();
            var ww = $('#wrapper').width();
            var space = ($(this).width() - hw - ww) / 2 / 2;

            var pageprev = $('#pageprev');
            var pagenext = $('#pagenext');
            var avg = (pageprev.width() + pagenext.width()) / 2

            if(space > avg) {
                var len = space - avg / 2;
                var styles = {position: 'fixed', top: '50%', marginTop: - (pageprev.width() + pagenext.width()) / 4}
                pageprev.css($.extend({left: hw + len}, styles));
                pagenext.css($.extend({right: len}, styles));
            } else {
                pageprev.removeAttr('style');
                pagenext.removeAttr('style');
            }
        }).trigger('resize');
        </script>
    

</body>
</html>
